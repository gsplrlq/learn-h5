import{d as E,Z as b,G as h,r as m,E as F,h as r,_ as B,c as D,b as a,w as d,a as w,B as C,o as g,f as i,aM as P,y as I}from"./index-B0fxC8bZ.js";import{C as R}from"./index-DU-sKvTT.js";import{R as V,a as M}from"./index-B3P-bxpQ.js";import{b as S,d as T,e as k}from"./order-Cm9IqA_q.js";const N=E({name:"PayPage",setup(){const t=b(),o=h(),s=t.params.orderSn,p=m({}),n=m("ali"),c=()=>{if(!n.value){r("请选择支付方式");return}T({orderSn:s,payType:n.value}).then(u=>{if(n.value==="ali"){r("正在使用支付宝支付...");const e=document.createElement("form");e.method="POST",e.action=u,e.style.display="none",document.body.appendChild(e),e.submit()}else n.value==="wechat"&&(r("正在使用微信支付..."),window.location.href=u);const l=setInterval(()=>{k({orderSn:s,payType:n.value}).then(e=>{e.paySuccess&&(clearInterval(l),r("支付成功"),o.replace("/my/order"))})},3e3)})};return F(async()=>{p.value=await S(s)}),{orderSn:s,orderInfo:p,paymentMethod:n,handlePayment:c}}}),$={class:"pay-page"},A={class:"p-4"};function G(t,o,s,p,n,c){const u=P,l=I,e=V,_=M,f=R,y=C;return g(),D("div",$,[a(u,{title:"支付中心"}),a(f,{class:"mb-4"},{default:d(()=>[a(l,{title:"订单号",label:t.orderSn},null,8,["label"]),a(l,{title:"应付金额",label:t.orderInfo.amount},null,8,["label"]),a(l,{title:"支付方式"}),a(_,{modelValue:t.paymentMethod,"onUpdate:modelValue":o[0]||(o[0]=v=>t.paymentMethod=v)},{default:d(()=>[a(e,{class:"p-4",name:"ali"},{default:d(()=>o[1]||(o[1]=[i("支付宝")])),_:1}),a(e,{class:"p-4",name:"wechat"},{default:d(()=>o[2]||(o[2]=[i("微信支付")])),_:1})]),_:1},8,["modelValue"])]),_:1}),w("div",A,[a(y,{class:"w-full",type:"primary",text:"确认支付",round:"",onClick:t.handlePayment},null,8,["onClick"])])])}const j=B(N,[["render",G],["__scopeId","data-v-7bdbd888"]]);export{j as default};
