import{q as Me,c as de,d as X,v as pe,x as fe,b as m,y as Y,z as le,A as j,B as me,w as ge,D as Ae,E as Le,G as Re,H as Ne,I as $e,J as Fe,K as U,L as qe,r as ze,M as _,N as Oe,a as L,O as oe,P as De,Q as We,R as je,S as D,U as Ue,V as Ye,W as R,X as He,Y as Ke,Z as K,$ as Ge,a0 as ie,m as Je,j as Q,a1 as Ze,e as re,f as G,g as F,n as Qe,o as W,k as se,u as q,t as J,a2 as Xe,a3 as et,a4 as tt,_ as nt}from"./index-t5ZCdKNL.js";import{c as at,a as lt,C as ot}from"./index-D3R3ZZRw.js";import{B as it}from"./index-NAckkiAV.js";let rt=0;function st(){const e=Me(),{name:n="unknown"}=(e==null?void 0:e.type)||{};return`${n}-${++rt}`}const[ut,ct]=de("form"),dt={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:Y,labelAlign:String,inputAlign:String,scrollToError:Boolean,scrollToErrorPosition:String,validateFirst:Boolean,submitOnEnter:le,showErrorMessage:le,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var ft=X({name:ut,props:dt,emits:["submit","failed"],setup(e,{emit:n,slots:s}){const{children:u,linkChildren:o}=pe(me),c=a=>a?u.filter(r=>a.includes(r.name)):u,V=a=>new Promise((r,v)=>{const S=[];c(a).reduce((H,N)=>H.then(()=>{if(!S.length)return N.validate().then($=>{$&&S.push($)})}),Promise.resolve()).then(()=>{S.length?v(S):r()})}),k=a=>new Promise((r,v)=>{const S=c(a);Promise.all(S.map(y=>y.validate())).then(y=>{y=y.filter(Boolean),y.length?v(y):r()})}),b=a=>{const r=u.find(v=>v.name===a);return r?new Promise((v,S)=>{r.validate().then(y=>{y?S(y):v()})}):Promise.reject()},C=a=>typeof a=="string"?b(a):e.validateFirst?V(a):k(a),g=a=>{typeof a=="string"&&(a=[a]),c(a).forEach(v=>{v.resetValidation()})},w=()=>u.reduce((a,r)=>(a[r.name]=r.getValidationStatus(),a),{}),d=(a,r)=>{u.some(v=>v.name===a?(v.$el.scrollIntoView(r),!0):!1)},P=()=>u.reduce((a,r)=>(r.name!==void 0&&(a[r.name]=r.formValue.value),a),{}),M=()=>{const a=P();C().then(()=>n("submit",a)).catch(r=>{n("failed",{values:a,errors:r});const{scrollToError:v,scrollToErrorPosition:S}=e;v&&r[0].name&&d(r[0].name,S?{block:S}:void 0)})},T=a=>{j(a),M()};return o({props:e}),fe({submit:M,validate:C,getValues:P,scrollToField:d,resetValidation:g,getValidationStatus:w}),()=>{var a;return m("form",{class:ct(),onSubmit:T},[(a=s.default)==null?void 0:a.call(s)])}}});const mt=ge(ft);function ve(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function gt(e,n){if(ve(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function vt(e,n){return new Promise(s=>{const u=n.validator(e,n);if(Ne(u)){u.then(s);return}s(u)})}function ue(e,n){const{message:s}=n;return $e(s)?s(e,n):s||""}function ht({target:e}){e.composing=!0}function ce({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function bt(e,n){const s=Ae();e.style.height="auto";let u=e.scrollHeight;if(Re(n)){const{maxHeight:o,minHeight:c}=n;o!==void 0&&(u=Math.min(u,o)),c!==void 0&&(u=Math.max(u,c))}u&&(e.style.height=`${u}px`,Le(s))}function yt(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function B(e){return[...e].length}function Z(e,n){return[...e].slice(0,n).join("")}const[St,x]=de("field"),Vt={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:Y,max:Number,min:Number,formatter:Function,clearIcon:U("clear"),modelValue:Ye(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:U("focus"),formatTrigger:U("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},xt=Fe({},at,Vt,{rows:Y,type:U("text"),rules:Array,autosize:[Boolean,Object],labelWidth:Y,labelClass:qe,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Ct=X({name:St,props:xt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:s}){const u=st(),o=ze({status:"unvalidated",focused:!1,validateMessage:""}),c=_(),V=_(),k=_(),{parent:b}=Oe(me),C=()=>{var t;return String((t=e.modelValue)!=null?t:"")},g=t=>{if(R(e[t]))return e[t];if(b&&R(b.props[t]))return b.props[t]},w=L(()=>{const t=g("readonly");if(e.clearable&&!t){const l=C()!=="",i=e.clearTrigger==="always"||e.clearTrigger==="focus"&&o.focused;return l&&i}return!1}),d=L(()=>k.value&&s.input?k.value():e.modelValue),P=L(()=>{var t;const l=g("required");return l==="auto"?(t=e.rules)==null?void 0:t.some(i=>i.required):l}),M=t=>t.reduce((l,i)=>l.then(()=>{if(o.status==="failed")return;let{value:f}=d;if(i.formatter&&(f=i.formatter(f,i)),!gt(f,i)){o.status="failed",o.validateMessage=ue(f,i);return}if(i.validator)return ve(f)&&i.validateEmpty===!1?void 0:vt(f,i).then(h=>{h&&typeof h=="string"?(o.status="failed",o.validateMessage=h):h===!1&&(o.status="failed",o.validateMessage=ue(f,i))})}),Promise.resolve()),T=()=>{o.status="unvalidated",o.validateMessage=""},a=()=>n("endValidate",{status:o.status,message:o.validateMessage}),r=(t=e.rules)=>new Promise(l=>{T(),t?(n("startValidate"),M(t).then(()=>{o.status==="failed"?(l({name:e.name,message:o.validateMessage}),a()):(o.status="passed",l(),a())})):l()}),v=t=>{if(b&&e.rules){const{validateTrigger:l}=b.props,i=ie(l).includes(t),f=e.rules.filter(h=>h.trigger?ie(h.trigger).includes(t):i);f.length&&r(f)}},S=t=>{var l;const{maxlength:i}=e;if(R(i)&&B(t)>+i){const f=C();if(f&&B(f)===+i)return f;const h=(l=c.value)==null?void 0:l.selectionEnd;if(o.focused&&h){const p=[...t],A=p.length-+i;return p.splice(h-A,A),p.join("")}return Z(t,+i)}return t},y=(t,l="onChange")=>{var i,f;const h=t;t=S(t);const p=B(h)-B(t);if(e.type==="number"||e.type==="digit"){const I=e.type==="number";t=He(t,I,I),l==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)&&(t=Ke(+t,(i=e.min)!=null?i:-1/0,(f=e.max)!=null?f:1/0).toString())}let A=0;if(e.formatter&&l===e.formatTrigger){const{formatter:I,maxlength:E}=e;if(t=I(t),R(E)&&B(t)>+E&&(t=Z(t,+E)),c.value&&o.focused){const{selectionEnd:O}=c.value,ae=Z(h,O);A=B(I(ae))-B(ae)}}if(c.value&&c.value.value!==t)if(o.focused){let{selectionStart:I,selectionEnd:E}=c.value;if(c.value.value=t,R(I)&&R(E)){const O=B(t);p?(I-=p,E-=p):A&&(I+=A,E+=A),c.value.setSelectionRange(Math.min(I,O),Math.min(E,O))}}else c.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},H=t=>{t.target.composing||y(t.target.value)},N=()=>{var t;return(t=c.value)==null?void 0:t.blur()},$=()=>{var t;return(t=c.value)==null?void 0:t.focus()},z=()=>{const t=c.value;e.type==="textarea"&&e.autosize&&t&&bt(t,e.autosize)},he=t=>{o.focused=!0,n("focus",t),D(z),g("readonly")&&N()},be=t=>{o.focused=!1,y(C(),"onBlur"),n("blur",t),!g("readonly")&&(v("onBlur"),D(z),Ze())},ee=t=>n("clickInput",t),ye=t=>n("clickLeftIcon",t),Se=t=>n("clickRightIcon",t),Ve=t=>{j(t),n("update:modelValue",""),n("clear",t)},te=L(()=>{if(typeof e.error=="boolean")return e.error;if(b&&b.props.showError&&o.status==="failed")return!0}),xe=L(()=>{const t=g("labelWidth"),l=g("labelAlign");if(t&&l!=="top")return{width:oe(t)}}),Ce=t=>{t.keyCode===13&&(!(b&&b.props.submitOnEnter)&&e.type!=="textarea"&&j(t),e.type==="search"&&N()),n("keypress",t)},ne=()=>e.id||`${u}-input`,ke=()=>o.status,Ie=()=>{const t=x("control",[g("inputAlign"),{error:te.value,custom:!!s.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(s.input)return m("div",{class:t,onClick:ee},[s.input()]);const l={id:ne(),ref:c,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:g("disabled"),readonly:g("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${u}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:be,onFocus:he,onInput:H,onClick:ee,onChange:ce,onKeypress:Ce,onCompositionend:ce,onCompositionstart:ht};return e.type==="textarea"?m("textarea",l,null):m("input",Je(yt(e.type),l),null)},_e=()=>{const t=s["left-icon"];if(e.leftIcon||t)return m("div",{class:x("left-icon"),onClick:ye},[t?t():m(K,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},we=()=>{const t=s["right-icon"];if(e.rightIcon||t)return m("div",{class:x("right-icon"),onClick:Se},[t?t():m(K,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Ee=()=>{if(e.showWordLimit&&e.maxlength){const t=B(C());return m("div",{class:x("word-limit")},[m("span",{class:x("word-num")},[t]),Q("/"),e.maxlength])}},Be=()=>{if(b&&b.props.showErrorMessage===!1)return;const t=e.errorMessage||o.validateMessage;if(t){const l=s["error-message"],i=g("errorMessageAlign");return m("div",{class:x("error-message",i)},[l?l({message:t}):t])}},Pe=()=>{const t=g("labelWidth"),l=g("labelAlign"),i=g("colon")?":":"";if(s.label)return[s.label(),i];if(e.label)return m("label",{id:`${u}-label`,for:s.input?void 0:ne(),"data-allow-mismatch":"attribute",onClick:f=>{j(f),$()},style:l==="top"&&t?{width:oe(t)}:void 0},[e.label+i])},Te=()=>[m("div",{class:x("body")},[Ie(),w.value&&m(K,{ref:V,name:e.clearIcon,class:x("clear")},null),we(),s.button&&m("div",{class:x("button")},[s.button()])]),Ee(),Be()];return fe({blur:N,focus:$,validate:r,formValue:d,resetValidation:T,getValidationStatus:ke}),De(Ge,{customValue:k,resetValidation:T,validateWithTrigger:v}),We(()=>e.modelValue,()=>{y(C()),T(),v("onChange"),D(z)}),je(()=>{y(C(),e.formatTrigger),D(z)}),Ue("touchstart",Ve,{target:L(()=>{var t;return(t=V.value)==null?void 0:t.$el})}),()=>{const t=g("disabled"),l=g("labelAlign"),i=_e(),f=()=>{const h=Pe();return l==="top"?[i,h].filter(Boolean):h||[]};return m(lt,{size:e.size,class:x({error:te.value,disabled:t,[`label-${l}`]:l}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:xe.value,valueClass:x("value"),titleClass:[x("label",[l,{required:P.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:i&&l!=="top"?()=>i:null,title:f,value:Te,extra:s.extra})}}});const kt=ge(Ct),It="/vue3-h5-template/static/ico/favicon-yZ9RYYti.ico",_t={class:"container"},wt={class:"m-6"},Et=X({name:"Login",__name:"index",setup(e){const n=_(!1),s=_(!1),u=_(""),o=_("");let c=_(60),V=_(60),k=_(null);const b=async()=>{if(!k.value&&V.value===c.value){const w={option:n.value?1:2,phone:u.value,type:"client"};await et(w),tt("发送成功"),k.value=setInterval(()=>{V.value--,V.value<=0&&(clearInterval(k.value),k.value=null,V.value=c.value)},1e3)}},C=w=>{const d={...w};n.value||(d.type=s.value?"smsCodeLogin":"pwdLogin"),Qe().login(d,n.value),console.log("submit",w)},g=()=>{u.value="",o.value=""};return(w,d)=>{const P=kt,M=it,T=ot,a=mt;return W(),re("div",_t,[d[5]||(d[5]=G("img",{class:"logo",src:It,alt:"",srcset:""},null,-1)),m(a,{onSubmit:C},{default:F(()=>[m(T,{inset:""},{default:F(()=>[m(P,{modelValue:u.value,"onUpdate:modelValue":d[0]||(d[0]=r=>u.value=r),name:"mobile",label:"手机号",placeholder:"手机号",rules:[{required:!0,message:"请填写手机号"}]},null,8,["modelValue"]),s.value?(W(),se(P,{key:1,modelValue:o.value,"onUpdate:modelValue":d[2]||(d[2]=r=>o.value=r),clearable:"",name:"code",label:"验证码",placeholder:"验证码",rules:[{required:!0,message:"请填写验证码"}]},{button:F(()=>[m(M,{size:"small",disabled:!u.value||q(V)!==q(c),onClick:b},{default:F(()=>[Q(J(q(V)===q(c)?"获取验证码":q(V)+"s 重新发送"),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])):(W(),se(P,{key:0,modelValue:o.value,"onUpdate:modelValue":d[1]||(d[1]=r=>o.value=r),type:"password",name:"code",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]))]),_:1}),G("div",wt,[m(M,{round:"",block:"",type:"danger","native-type":"submit"},{default:F(()=>[Q(J(n.value?"注册":"登录"),1)]),_:1}),G("div",{class:"text-center text-xl text-current p-6",onClick:d[3]||(d[3]=r=>{n.value=!1,s.value=!s.value,g()})},J(s.value?"账号密码登录":"手机短信登录"),1),n.value?Xe("",!0):(W(),re("div",{key:0,class:"text-center text-large text-red-500 p-6",onClick:d[4]||(d[4]=r=>{n.value=!0,s.value=!0,g()})}," 快速注册 "))])]),_:1})])}}}),Mt=nt(Et,[["__scopeId","data-v-18a4e412"]]);export{Mt as default};
