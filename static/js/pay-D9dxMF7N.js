import{d as b,Z as h,E as w,r as m,G as g,h as d,_ as C,c as P,o as B,b as a,a as I,ax as R,w as p,y as V,g as i,B as S}from"./index-2WoK3mnG.js";import{C as T}from"./index-C8KzbB-k.js";import{R as k,a as M}from"./index-BYk1u5Fr.js";import{b as N,d as $,e as E}from"./order-TNH96eAa.js";const G=b({name:"PayPage",setup(){const t=h(),o=w(),s=t.params.orderSn,c=m({}),n=m("ali"),u=()=>{if(!n.value){d("请选择支付方式");return}$({orderSn:s,payType:n.value}).then(r=>{if(n.value==="ali"){d("正在使用支付宝支付...");const e=document.createElement("form");e.method="POST",e.action=r,e.style.display="none",document.body.appendChild(e),e.submit()}else n.value==="wechat"&&(d("正在使用微信支付..."),window.location.href=r);const l=setInterval(()=>{E({orderSn:s,payType:n.value}).then(e=>{e.paySuccess&&(clearInterval(l),d("支付成功"),o.replace("/my/order"))})},3e3)})};return g(async()=>{c.value=await N(s)}),{orderSn:s,orderInfo:c,paymentMethod:n,handlePayment:u}}}),x={class:"pay-page"},O={class:"p-4"};function U(t,o,s,c,n,u){const r=R,l=V,e=M,_=k,f=T,y=S;return B(),P("div",x,[a(r,{title:"支付中心"}),a(f,{class:"mb-4"},{default:p(()=>[a(l,{title:"订单号",label:t.orderSn},null,8,["label"]),a(l,{title:"应付金额",label:t.orderInfo.amount},null,8,["label"]),a(l,{title:"支付方式"}),a(_,{modelValue:t.paymentMethod,"onUpdate:modelValue":o[0]||(o[0]=v=>t.paymentMethod=v)},{default:p(()=>[a(e,{class:"p-4",name:"ali"},{default:p(()=>[...o[1]||(o[1]=[i("支付宝",-1)])]),_:1}),a(e,{class:"p-4",name:"wechat"},{default:p(()=>[...o[2]||(o[2]=[i("微信支付",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),I("div",O,[a(y,{class:"w-full",type:"primary",text:"确认支付",round:"",onClick:t.handlePayment},null,8,["onClick"])])])}const A=C(G,[["render",U],["__scopeId","data-v-7bdbd888"]]);export{A as default};
