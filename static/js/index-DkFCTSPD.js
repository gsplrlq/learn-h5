import{c as L,d as A,u as M,a as R,b as g,n as U,t as P,F as Y,p as $,w as j,r as v,o as S,e as F,f as k,g as b,h as T,i as h,j as q,k as w,l as D,s as O,m as z,q as G,B as K,_ as W}from"./index-DqmQnYxG.js";import{C as Z}from"./index-CEOxUoRy.js";import{F as H}from"./index-QMDOCG9B.js";const[J,Q]=L("form"),X={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:U,labelAlign:String,inputAlign:String,scrollToError:Boolean,scrollToErrorPosition:String,validateFirst:Boolean,submitOnEnter:P,showErrorMessage:P,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var ee=A({name:J,props:X,emits:["submit","failed"],setup(V,{emit:s,slots:i}){const{children:o,linkChildren:c}=M(Y),d=e=>e?o.filter(t=>e.includes(t.name)):o,u=e=>new Promise((t,a)=>{const n=[];d(e).reduce((N,I)=>N.then(()=>{if(!n.length)return I.validate().then(E=>{E&&n.push(E)})}),Promise.resolve()).then(()=>{n.length?a(n):t()})}),f=e=>new Promise((t,a)=>{const n=d(e);Promise.all(n.map(r=>r.validate())).then(r=>{r=r.filter(Boolean),r.length?a(r):t()})}),x=e=>{const t=o.find(a=>a.name===e);return t?new Promise((a,n)=>{t.validate().then(r=>{r?n(r):a()})}):Promise.reject()},y=e=>typeof e=="string"?x(e):V.validateFirst?u(e):f(e),B=e=>{typeof e=="string"&&(e=[e]),d(e).forEach(a=>{a.resetValidation()})},m=()=>o.reduce((e,t)=>(e[t.name]=t.getValidationStatus(),e),{}),l=(e,t)=>{o.some(a=>a.name===e?(a.$el.scrollIntoView(t),!0):!1)},p=()=>o.reduce((e,t)=>(t.name!==void 0&&(e[t.name]=t.formValue.value),e),{}),_=()=>{const e=p();y().then(()=>s("submit",e)).catch(t=>{s("failed",{values:e,errors:t});const{scrollToError:a,scrollToErrorPosition:n}=V;a&&t[0].name&&l(t[0].name,n?{block:n}:void 0)})},C=e=>{$(e),_()};return c({props:V}),R({submit:_,validate:y,getValues:p,scrollToField:l,resetValidation:B,getValidationStatus:m}),()=>{var e;return g("form",{class:Q(),onSubmit:C},[(e=i.default)==null?void 0:e.call(i)])}}});const te=j(ee),le="/vue3-h5-template/static/ico/favicon-yZ9RYYti.ico",ae={class:"container"},oe={class:"m-6"},ne=A({name:"Login",__name:"index",setup(V){const s=v(!1),i=v(!1),o=v(""),c=v("");let d=v(60),u=v(60),f=v(null);const x=async()=>{if(!f.value&&u.value===d.value){const m={option:s.value?1:2,phone:o.value,type:"client"};await O(m),z("发送成功"),f.value=setInterval(()=>{u.value--,u.value<=0&&(clearInterval(f.value),f.value=null,u.value=d.value)},1e3)}},y=m=>{const l={...m};s.value||(l.type=i.value?"smsCodeLogin":"pwdLogin"),G().login(l,s.value),console.log("submit",m)},B=()=>{o.value="",c.value=""};return(m,l)=>{const p=H,_=K,C=Z,e=te;return S(),F("div",ae,[l[5]||(l[5]=k("img",{class:"logo",src:le,alt:"",srcset:""},null,-1)),g(e,{onSubmit:y},{default:b(()=>[g(C,{inset:""},{default:b(()=>[g(p,{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=t=>o.value=t),name:"mobile",label:"手机号",placeholder:"手机号",rules:[{required:!0,message:"请填写手机号"}]},null,8,["modelValue"]),i.value?(S(),T(p,{key:1,modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=t=>c.value=t),clearable:"",name:"code",label:"验证码",placeholder:"验证码",rules:[{required:!0,message:"请填写验证码"}]},{button:b(()=>[g(_,{size:"small",disabled:!o.value||h(u)!==h(d),onClick:x},{default:b(()=>[q(w(h(u)===h(d)?"获取验证码":h(u)+"s 重新发送"),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])):(S(),T(p,{key:0,modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=t=>c.value=t),type:"password",name:"code",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]))]),_:1}),k("div",oe,[g(_,{round:"",block:"",type:"danger","native-type":"submit"},{default:b(()=>[q(w(s.value?"注册":"登录"),1)]),_:1}),k("div",{class:"text-center text-xl text-current p-6",onClick:l[3]||(l[3]=t=>{s.value=!1,i.value=!i.value,B()})},w(i.value?"账号密码登录":"手机短信登录"),1),s.value?D("",!0):(S(),F("div",{key:0,class:"text-center text-large text-red-500 p-6",onClick:l[4]||(l[4]=t=>{s.value=!0,i.value=!0,B()})}," 快速注册 "))])]),_:1})])}}}),ue=W(ne,[["__scopeId","data-v-18a4e412"]]);export{ue as default};
